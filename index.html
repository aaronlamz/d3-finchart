<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FinChart SDK Test</title>
  </head>
  <body>
    <div id="chart-container"></div>
    <script type="module">
      // 直接引入 src/index.js 中的代码，不需要打包文件
      import FinChart from '/src/index.js'
      import tencentData from '/public/time-chart-data.json'
      import { formatLatestTime } from './src/utils/format'

      const container = document.getElementById('chart-container')

      const timeChartData = tencentData.data.data[0].list[0].list.map(
        (item) => {
          const timestamp = formatLatestTime(item.latestTime)
          const price = item.price ? item.price / 1000 : 0
          const avg = item.avg ? item.avg / 1000 : 0

          if (isNaN(timestamp) || isNaN(price) || isNaN(avg)) {
            console.error('Invalid data:', { timestamp, price, avg })
          }

          return {
            timestamp,
            price,
            avg,
          }
        }
      )
      console.log('timeChartData', timeChartData)

      // 初始化分时图，支持现价线和均价线
      const lineChart = new FinChart.charts.LineChart(container, {
        width: 800,
        height: 400,
        timeScale: 'minute', // 分时图
        data: timeChartData,
      })
    </script>
  </body>
</html>
